<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Deriv Trade Demo</title>
<style>
 body { background:#000; color:#fff; font-family:Arial; margin:0; }
 header { background:#111; padding:15px; border-bottom:3px solid #e30613; }
 h1 { margin:0; color:#e30613; }
 .container { padding:20px; }
 .demo-box { background:#0b0b0b; border:1px solid #222; padding:20px; border-radius:10px; max-width:700px; margin:auto; }
 .balance { font-size:28px; font-weight:900; color:#2bd17d; }
 .btn { background:#e30613; border:none; padding:10px 18px; border-radius:8px; color:#fff; cursor:pointer; font-weight:800; }
 .chart { background:#050505; height:300px; border-radius:10px; margin-top:20px; border:1px solid #111; }
 .trade-buttons { display:flex; gap:10px; margin-top:20px; }
 .buy { background:#2bd17d; }
 .sell { background:#ff5b5b; }
</style>
</head>
<body>
<header>
  <h1>Deriv_Trade Demo Account</h1>
</header><div class="container">
  <div class="demo-box"><!-- Currency Selector Added -->
<label style="font-size:14px; color:#bbb;">Select Asset:</label>
<select id="asset" class="input" style="width:100%; padding:10px; background:#111; color:#fff; border-radius:8px; margin-top:6px; margin-bottom:18px;">
    <option value="XAUUSD">Gold (XAU/USD)</option>
    <option value="EURUSD">EUR / USD</option>
    <option value="GBPUSD">GBP / USD</option>
    <option value="BTCUSD">Bitcoin (BTC/USD)</option>
    <option value="USDJPY">USD / JPY</option>
</select>
<h2>Demo Account</h2>
<p>Practice trading using virtual funds. This demo account allows you to test strategies, learn charts, and place mock trades.</p>

<div class="balance">Balance: KES <span id="bal">10000</span></div>

<div class="chart" id="chart"></div>

<div class="trade-buttons">
  <button class="btn buy" onclick="trade('buy')">Buy</button>
  <button class="btn sell" onclick="trade('sell')">Sell</button>
  <button class="btn" onclick="resetBal()">Reset Balance</button>
</div>

<div id="log" style="margin-top:20px; font-size:14px; color:#aaa"></div>

  </div>
</div><script>
// Load Lightweight Charts
const script = document.createElement('script');
script.src = "https://unpkg.com/lightweight-charts@3.9.0/dist/lightweight-charts.standalone.production.js";
document.head.appendChild(script);

script.onload = () => {

  /* ==========================
     ASSET SYSTEM UPGRADED
     - Live price movement
     - Spread added
     - Asset icons
     - Realistic pip movement
  ===========================*/

  const assetList = {
    'XAUUSD': { price:1800, icon:'ðŸ¥‡ Gold', pip:0.15, spread:1.2 },
    'EURUSD': { price:1.09, icon:'ðŸ‡ªðŸ‡º / ðŸ‡ºðŸ‡¸ EUR/USD', pip:0.00012, spread:0.8 },
    'GBPUSD': { price:1.27, icon:'ðŸ‡¬ðŸ‡§ / ðŸ‡ºðŸ‡¸ GBP/USD', pip:0.00015, spread:1.0 },
    'BTCUSD': { price:38000, icon:'â‚¿ Bitcoin', pip:12, spread:25 },
    'USDJPY': { price:147, icon:'ðŸ‡ºðŸ‡¸ / ðŸ‡¯ðŸ‡µ USD/JPY', pip:0.18, spread:1.6 },
  };

  let currentAsset = 'XAUUSD';

  document.getElementById('asset').onchange = function(){
      currentAsset = this.value;
      candleSeries.setData(generateData(assetList[currentAsset].price));
      showAssetInfo();
  };

  function showAssetInfo(){
      const a = assetList[currentAsset];
      document.getElementById('log').innerHTML =
      `<div style='margin-top:10px; color:#fff;'><b>Asset:</b> ${a.icon}<br>
       <b>Spread:</b> ${a.spread}<br>
       <b>Pip Value:</b> ${a.pip}</div>`;
  }

  /* ==========================
     LIVE PRICE MOVEMENT
  ===========================*/
  setInterval(()=>{
      let a = assetList[currentAsset];
      let move = (Math.random()-0.5) * a.pip;
      a.price += move;

      const last = chartData[chartData.length-1];
      const newCandle = {
        time: Math.floor(Date.now()/1000),
        open:last.close,
        close:a.price,
        high: Math.max(last.close, a.price) + Math.random()*a.pip,
        low: Math.min(last.close, a.price) - Math.random()*a.pip,
      };

      chartData.push(newCandle);
      if(chartData.length>200) chartData.shift();

      candleSeries.setData(chartData);
  }, 1800);

  /* ==========================
     CHART DATA GENERATOR
  ===========================*/
  let chartData = [];
  function generateData(base){
    let data=[]; let t=Math.floor(Date.now()/1000)-3000; let price=base;
    for(let i=0;i<80;i++){
        let open=price+(Math.random()-0.5)*2;
        let close=open+(Math.random()-0.5)*2;
        let high=Math.max(open,close)+Math.random()*1.5;
        let low=Math.min(open,close)-Math.random()*1.5;
        data.push({time:t,open,high,low,close});
        price=close;
        t+=60;
    }
    chartData = data;
    return data;
  }

  /* ==========================
     TRADING ENGINE UPDATED
     - Spread applied
     - Per-asset price
     - Realistic pip moves
  ===========================*/

  let bal = 10000;
  function update(){ document.getElementById('bal').innerText = bal; }

  window.trade = function(type){
      let a = assetList[currentAsset];
      let direction = type === 'buy' ? 1 : -1;

      // Spread applied
      let entry = a.price + (a.spread * (Math.random()*0.3)) * direction;

      // Price movement simulation
      let movement = (Math.random()-0.5) * a.pip * 40;
      let pnl = Math.floor(movement * direction);

      bal += pnl;
      update();

      document.getElementById('log').innerHTML +=
      `<div><b>${type.toUpperCase()}</b> | ${a.icon} | Result: KES ${pnl}</div>`;
  }

  window.resetBal = function(){ bal=10000; update(); document.getElementById('log').innerHTML=''; }
  update();
  showAssetInfo();
};

  const assetList = {
    'XAUUSD': 1800,
    'EURUSD': 1.09,
    'GBPUSD': 1.27,
    'BTCUSD': 38000,
    'USDJPY': 147,
  };

  let currentAsset = 'XAUUSD';

  document.getElementById('asset').onchange = function(){
      currentAsset = this.value;
      candleSeries.setData(generateData(assetList[currentAsset]));
  };
  const chartEl = document.getElementById('chart');
  const chart = LightweightCharts.createChart(chartEl, {
    layout: { backgroundColor: '#050505', textColor:'#ccc' },
    grid: { vertLines: { color:'rgba(255,255,255,0.05)'}, horzLines:{ color:'rgba(255,255,255,0.05)'}},
    width: chartEl.clientWidth,
    height: chartEl.clientHeight
  });

  const candleSeries = chart.addCandlestickSeries({
    upColor:'#2bd17d', downColor:'#ff5b5b', borderUpColor:'#2bd17d', borderDownColor:'#ff5b5b',
  });

  function generateData(){
    let data = []; let time = Math.floor(Date.now()/1000) - 60*60;
    let price = 1800;
    for(let i=0;i<100;i++){
      const open = price + (Math.random()-0.5)*5;
      const close = open + (Math.random()-0.5)*5;
      const high = Math.max(open, close) + Math.random()*3;
      const low = Math.min(open, close) - Math.random()*3;
      data.push({ time, open, high, low, close });
      price = close; time += 60;
    }
    return data;
  }

  candleSeries.setData(generateData());

  // Demo trading logic kept intact
  let bal = 10000;
  function update(){ document.getElementById('bal').innerText = bal; }
  window.trade = function(type){ let change = Math.floor(Math.random()*800)-400; bal += change; update(); document.getElementById('log').innerHTML += `<div>${type.toUpperCase()} trade result: KES ${change}</div>`; }
  window.resetBal = function(){ bal=10000; update(); document.getElementById('log').innerHTML=''; }
  update();
};
</script></body>
</html>
